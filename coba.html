<!DOCTYPE html>
<html>
  <head>
     <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/1.11.3/css/dataTables.bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/fixedheader/3.2.0/css/fixedHeader.bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/responsive/2.2.9/css/responsive.bootstrap.min.css"
    />
    <title>KAS MASJID </title>
  </head>
  <body>
 <div class="container">
      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <h3 class="text-center mb-4">Kas Masjid</h3>
          <h4 class="text-center mb-4" id="packageName"></h4>
          <br>
          <br>
          <a href="https://sites.google.com/view/masjidmu-at-taqwa" type="button" class="btn btn-primary mt-3 mb-3">+ Kembali </a>
          <br>
          <br>
          <table
            id="example"
            class="table table-striped table-bordered mt-2 mb-2"
            style="width: 100%"
          ></table>
          <br />
          <br />
          <p id="passingGrade"></p>
        </div>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.3/js/dataTables.bootstrap.min.js"></script>
    <script src="https://cdn.datatables.net/fixedheader/3.2.0/js/dataTables.fixedHeader.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.9/js/responsive.bootstrap.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script type="text/javascript" src="data.json"></script>
    <script type="text/javascript">
    const formatRibuan = (angka) => {
      if (!angka && angka !== 0) return '';
      return angka.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
      };
    const unformatRibuan = (str) => {
      if (!str) return 0;
      return Number(str.toString().replace(/\./g, ''));
      };
      // FUNGSI UNTUK MEMFORMAT TANGGAL DENGAN WAKTU LOKAL
    const formatTanggalTampilan = (dateString) => {
        if (!dateString) return '';
        
        // Membuat objek Date dari string ISO (ini menangani offset UTC secara otomatis)
        const dateObj = new Date(dateString);

        if (isNaN(dateObj.getTime())) return dateString;

        // Menggunakan Intl.DateTimeFormat untuk format lokal Indonesia yang lengkap
        return new Intl.DateTimeFormat('id-ID', {
            day: '2-digit',
            month: 'short',
            year: 'numeric',
            
        }).format(dateObj);
    };
    // ----------------------------------------


           $(document).ready(function () {
    $("#example").DataTable({
      ajax: "https://script.google.com/macros/s/AKfycbyX6F52puSYutp_ucUc2v5QP9TbUfukEMj3IBsPJjCqv4ul9YuXWYumorpFOlq9Ryy6-g/exec",
      columns: [
      {
          title: "NO",
          data: "NO",
          width: "5%" // Menyesuaikan lebar kolom agar lebih ringkas
        },
        { 
          title: "TANGGAL",
          data: "TANGGAL",
          // --- SOLUSI: Tambahkan properti render di sini ---
          render: (data, type) => {
             // Hanya format untuk tampilan layar ('display') atau pencarian ('filter')
             if (type === 'display' || type === 'filter') {
                 return formatTanggalTampilan(data);
             }
             // Biarkan data mentah (string ISO) untuk sorting/pengurutan
             return data;
          },
          width: "7%" // Menyesuaikan lebar kolom agar muat
         },
        {
          title: 'KETERANGAN',
          data: 'KETERANGAN',
          
        },
        
        {
          title: "KAS MASUK",
          data: "KAS MASUK", render: (data, type) => (type === 'display' || type === 'filter') ? formatRibuan(data) : data,
          width: "12%" // Menyesuaikan lebar kolom agar muat
        },
        {
          title: "KAS KELUAR",
          data: "KAS KELUAR", render: (data, type) => (type === 'display' || type === 'filter') ? formatRibuan(data) : data,
          width: "12%" // Menyesuaikan lebar kolom agar muat
        },
        {
          title: "SALDU (Rp)",
          data: "SALDU",render: (data, type) => (type === 'display' || type === 'filter') ? formatRibuan(data) : data,
          width: "12%" // Menyesuaikan lebar kolom agar muat
        }
       
      ],
      rowId: "SALDU",
      liveAjax: true,
    });
  });
    </script>
    </body>
</html>

